# Langfuse 3.0 Environment Configuration
# Copy this file to .env and customize for your deployment

################################################################################
# PostgreSQL Configuration
################################################################################
# Primary database credentials
POSTGRES_PASSWORD=langfuse123
# Optional: Override default port (5432)
POSTGRES_PORT=5432

################################################################################
# ClickHouse Configuration
################################################################################
# Analytics database credentials
CLICKHOUSE_PASSWORD=langfuse123
# Optional: Override default port (8123)
CLICKHOUSE_PORT=8123

################################################################################
# Redis Configuration
################################################################################
# Cache and queue system credentials
REDIS_PASSWORD=langfuse123
# Optional: Override default port (6379)
REDIS_PORT=6379

################################################################################
# MinIO / S3 Storage Configuration
################################################################################
# MinIO Credentials (local S3-compatible storage)
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin123
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001

# AWS S3 Configuration (ALTERNATIVE to MinIO)
# Uncomment and configure to use AWS S3 instead of MinIO
# AWS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your-access-key-id
# AWS_SECRET_ACCESS_KEY=your-secret-access-key
# Langfuse will automatically use S3 if credentials are provided

################################################################################
# Langfuse Web Application
################################################################################
# Port for web interface (default: 3000)
LANGFUSE_PORT=3000

# NextAuth Configuration - IMPORTANT: Change these in production
# Generate a secure secret: openssl rand -base64 32
NEXTAUTH_SECRET=replaceme-secret-key-min-32-characters

# Application URL (used for OAuth callbacks, email links)
# For local development:
NEXTAUTH_URL=http://localhost:3000
# For production (example):
# NEXTAUTH_URL=https://langfuse.yourdomain.com

# Disable signups for self-hosted (default: false - signups enabled)
# Set to "true" to disable new user registrations
NEXT_PUBLIC_SIGN_UP_DISABLED=false

# Enable blob storage logging (stores trace payloads)
LANGFUSE_ENABLE_BLOB_STORAGE_FILE_LOG=true

################################################################################
# Langfuse Worker
################################################################################
# Port for worker service (default: 3030)
LANGFUSE_WORKER_PORT=3030

################################################################################
# Email Configuration (Optional)
################################################################################
# For sending user invitation emails
# Format: smtp://username:password@host:port
# Examples:
# SMTP_CONNECTION_URL=smtp://user@gmail.com:password@smtp.gmail.com:587
# SMTP_CONNECTION_URL=smtp://user:password@mail.example.com:587
# Leave commented to disable email notifications

# SMTP_CONNECTION_URL=

################################################################################
# Observability & Analytics
################################################################################
# Disable telemetry if desired (default: true - telemetry enabled)
# Telemetry is anonymous and helps Langfuse team understand usage
# Set to "false" to opt-out
TELEMETRY_ENABLED=true

################################################################################
# Optional: Sentry Error Tracking
################################################################################
# For production error monitoring and performance tracing
# NEXT_PUBLIC_SENTRY_DSN=https://xxxxx@sentry.io/project
# SENTRY_AUTH_TOKEN=your-sentry-auth-token
# SENTRY_ORG=your-org
# SENTRY_PROJECT=your-project

################################################################################
# Optional: PostHog Analytics
################################################################################
# For tracking application usage and feature adoption
# NEXT_PUBLIC_POSTHOG_KEY=your-posthog-key
# NEXT_PUBLIC_POSTHOG_HOST=https://your-posthog-instance.com

################################################################################
# Advanced: ClickHouse Cluster Configuration
################################################################################
# For high-availability ClickHouse deployments
# CLICKHOUSE_CLUSTER_ENABLED=true
# CLICKHOUSE_CLUSTER_NAME=default
# Only enable if running ClickHouse cluster setup

################################################################################
# Advanced: Azure Blob Storage
################################################################################
# Alternative to MinIO or AWS S3
# LANGFUSE_USE_AZURE_BLOB=false
# LANGFUSE_AZURE_SKIP_CONTAINER_CHECK=true
# AZURE_STORAGE_CONNECTION_STRING=your-connection-string

################################################################################
# Advanced: Google Cloud Storage
################################################################################
# Alternative to MinIO or AWS S3
# LANGFUSE_USE_GOOGLE_CLOUD_STORAGE=false
# LANGFUSE_GOOGLE_CLOUD_STORAGE_CREDENTIALS=your-gcs-credentials-json

################################################################################
# Performance Tuning
################################################################################
# ClickHouse settings for better performance
# Increase these on larger deployments
# CLICKHOUSE_MAX_INSERT_THREADS=4
# CLICKHOUSE_MAX_MEMORY_USAGE=10000000000  # 10GB

################################################################################
# Database Connection Tuning
################################################################################
# Advanced PostgreSQL connection parameters
# DATABASE_ARGS=sslmode=require&application_name=langfuse
# DATABASE_POOL_SIZE=20

################################################################################
# Notes
################################################################################
#
# 1. SECURITY
#    - Change all default passwords before production deployment
#    - Generate secure secrets: openssl rand -base64 32
#    - Store this file securely (git-ignored)
#    - Use secrets manager for production (AWS Secrets, Azure Key Vault, etc)
#
# 2. PERFORMANCE
#    - Scale workers for high-throughput scenarios
#    - Use managed database services for HA
#    - Consider Redis Cluster for caching
#    - Monitor disk space for ClickHouse
#
# 3. STORAGE
#    - MinIO requires ~10GB+ for typical deployments
#    - ClickHouse grows with trace volume (~1GB per 1M traces)
#    - PostgreSQL ~1GB for 100K API keys
#    - Plan storage accordingly
#
# 4. NETWORKING
#    - All services communicate via container network (langfuse)
#    - Ports exposed only as needed
#    - Use firewall rules to restrict access
#    - HTTPS recommended for production
#
# 5. BACKUP & RECOVERY
#    - Regular PostgreSQL backups (daily minimum)
#    - ClickHouse data snapshots for large deployments
#    - Test restore procedures regularly
#    - Keep database backups in separate location
#
# 6. MONITORING
#    - Monitor container health via docker stats
#    - Track database performance
#    - Set up alerts for errors
#    - Monitor disk usage on storage services
#
################################################################################
